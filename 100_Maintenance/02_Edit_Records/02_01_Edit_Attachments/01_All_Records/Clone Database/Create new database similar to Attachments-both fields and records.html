<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attachment Field List</title>

    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { font-size: 24px; }
        .container { max-width: 800px; margin: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background: #f4f4f4; }
        button {
            padding: 10px 20px;
            background: #007BFF;
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover { background: #0056b3; }
        #messageBox { margin-top: 15px; height: 20px; font-weight: bold; }
    </style>
</head>

<body>
<div class="container">
    <h1>Attachment Field List</h1>

    <button id="cloneBtn">Clone Attachments → Attachments_BHL</button>

    <div id="messageBox"></div>

    <table>
        <thead>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
            </tr>
        </thead>
        <tbody id="fieldsBody"></tbody>
    </table>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
import { 
    getFirestore, collection, getDocs, doc, setDoc
} from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "attachments-df167.firebaseapp.com",
    projectId: "attachments-df167",
    storageBucket: "attachments-df167.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const AttachmentsCol = collection(db, "Attachments");
const NewCollectionName = "Attachments_BHL";

function showMessage(msg, error=false){
    const box = document.getElementById("messageBox");
    box.textContent = msg;
    box.style.color = error ? "red" : "green";
}

async function cloneTable() {
    try {
        showMessage("Cloning…");

        const snapshot = await getDocs(AttachmentsCol);

        let count = 0;

        for (const srcDoc of snapshot.docs) {
            await setDoc(doc(db, NewCollectionName, srcDoc.id), srcDoc.data());
            count++;
        }

        showMessage(`Created ${NewCollectionName} with ${count} docs.`);
    } 
    catch (err) {
        console.error("CLONE ERROR:", err);
        showMessage("Error cloning table: " + err.message, true);
    }
}

document.getElementById("cloneBtn").addEventListener("click", cloneTable);
</script>
</body>
</html>
